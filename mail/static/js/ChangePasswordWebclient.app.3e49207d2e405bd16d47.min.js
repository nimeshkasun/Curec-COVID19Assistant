(window.webpackJsonp=window.webpackJsonp||[]).push([[1],{"3Y+r":function(s,o,n){"use strict";var t=n("F/us"),e=n("SQrT"),r={checkIfFieldsEmpty:function(s,o){var n=t.find(s,(function(s){return""===s()}));return!n||(o&&e.showError(o),n.focused(!0),!1)},checkPassword:function(s,o){var t=n("RN+F"),r=n("hPb3"),i=!1;return o!==s?e.showError(t.i18n("COREWEBCLIENT/ERROR_PASSWORDS_DO_NOT_MATCH")):r.PasswordMinLength>0&&s.length<r.PasswordMinLength?e.showError(t.i18n("COREWEBCLIENT/ERROR_PASSWORD_TOO_SHORT").replace("%N%",r.PasswordMinLength)):!r.PasswordMustBeComplex||s.match(/([0-9])/)&&s.match(/([!,%,&,@,#,$,^,*,?,_,~])/)?i=!0:e.showError(t.i18n("COREWEBCLIENT/ERROR_PASSWORD_TOO_SIMPLE")),i}};s.exports=r},"4RXH":function(s,o,n){"use strict";var t=n("F/us"),e=n("AFLV");s.exports={ShowSingleMailChangePasswordInCommonSettings:!1,init:function(s){var o=s.ChangePasswordWebclient;t.isEmpty(o)||(this.ShowSingleMailChangePasswordInCommonSettings=e.pBool(o.ShowSingleMailChangePasswordInCommonSettings,this.ShowSingleMailChangePasswordInCommonSettings))}}},MLmf:function(s,o,n){"use strict";s.exports=function(s){if(n("IAk5").isUserNormalOrTenant()){var o=n("4RXH");return o.init(s),{start:function(s){o.ShowSingleMailChangePasswordInCommonSettings&&s.run("SettingsWebclient","registerSettingsTabSection",[function(){return n("btIU")},"common","common"])},getChangePasswordPopup:function(){return n("a7cI")},isChangePasswordButtonAllowed:function(s,n){return(!o.ShowSingleMailChangePasswordInCommonSettings||s>1)&&!!n.aExtend.AllowChangePasswordOnMailServer}}}return null}},a7cI:function(s,o,n){"use strict";var t=n("F/us"),e=n("EVdn"),r=n("0h2I"),i=n("RN+F"),a=(n("ZP6a"),n("3Y+r")),h=n("o0Bx"),c=n("JFZZ"),u=n("IAk5"),d=n("SQrT"),l=n("76Kh"),w=n("1grR"),P=n("czxF");n("4RXH");function S(){P.call(this),this.currentPassword=r.observable(""),this.newPassword=r.observable(""),this.confirmPassword=r.observable(""),this.accountId=r.observable(""),this.hasOldPassword=r.observable(!1),this.oParams=null}t.extendOwn(S.prototype,P.prototype),S.prototype.PopupTemplate="ChangePasswordWebclient_ChangePasswordPopup",S.prototype.onOpen=function(s){this.currentPassword(""),this.newPassword(""),this.confirmPassword(""),this.accountId(s.iAccountId),this.hasOldPassword(s.bHasOldPassword),this.oParams=s},S.prototype.change=function(){var s=e.trim(this.newPassword()),o=e.trim(this.confirmPassword());a.checkPassword(s,o)&&this.sendChangeRequest()},S.prototype.sendChangeRequest=function(){var s={AccountId:this.accountId(),CurrentPassword:e.trim(this.currentPassword()),NewPassword:e.trim(this.newPassword())},o={Module:this.oParams.sModule,Method:"ChangePassword"};h.send(this.oParams.sModule,"ChangePassword",s,this.onUpdatePasswordResponse,this),h.abortAndStopSendRequests(o)},S.prototype.onUpdatePasswordResponse=function(s,o){!1===s.Result?(c.showErrorByCode(s,i.i18n("CHANGEPASSWORDWEBCLIENT/ERROR_PASSWORD_NOT_SAVED")),h.startSendRequests()):s.Result&&s.Result.RefreshToken?(u.setAuthToken(s.Result.RefreshToken),l.showPopup(w,[i.i18n("CHANGEPASSWORDWEBCLIENT/REPORT_PASSWORD_CHANGED")+" "+i.i18n("CHANGEPASSWORDWEBCLIENT/REPORT_REDIRECT_TO_LOGIN"),function(){u.logout()}])):(this.hasOldPassword()?d.showReport(i.i18n("CHANGEPASSWORDWEBCLIENT/REPORT_PASSWORD_CHANGED")):d.showReport(i.i18n("CHANGEPASSWORDWEBCLIENT/REPORT_PASSWORD_SET")),this.closePopup(),e.isFunction(this.oParams.fAfterPasswordChanged)&&this.oParams.fAfterPasswordChanged())},s.exports=new S},btIU:function(s,o,n){"use strict";var t=n("F/us"),e=n("0h2I"),r=n("OgeD"),i=n("76Kh"),a=r.run("ChangePasswordWebclient","getChangePasswordPopup");n("4RXH");function h(){this.oSingleMailAccount=null,this.showChangePasswordButton=e.observable(!1),this.init()}h.prototype.ViewTemplate="ChangePasswordWebclient_ChangeSingleMailAccountPasswordView",h.prototype.init=function(){var s=r.run("MailWebclient","getAccountList",[]),o=function(){1===s.collection().length?(this.oSingleMailAccount=s.collection()[0],this.showChangePasswordButton(!0)):(this.oSingleMailAccount=null,this.showChangePasswordButton(!1))}.bind(this);s&&t.isFunction(s.collection)&&(o(),s.collection.subscribe(o))},h.prototype.changePassword=function(){this.oSingleMailAccount&&i.showPopup(a,[{iAccountId:this.oSingleMailAccount.id(),sModule:"Mail",bHasOldPassword:!0}])},s.exports=new h}}]);