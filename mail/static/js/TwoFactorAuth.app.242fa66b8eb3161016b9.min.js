(window.webpackJsonp=window.webpackJsonp||[]).push([[25],{"2xdY":function(o,t,i){"use strict";var e=i("F/us"),n=i("0h2I"),s=i("SQrT"),r=i("RN+F"),a=i("czxF"),h=i("o0Bx");function c(){a.call(this),this.onConfirm=null,this.password=n.observable(""),this.inPropgress=n.observable(!1),this.action=""}e.extendOwn(c.prototype,a.prototype),c.prototype.PopupTemplate="TwoFactorAuth_ConfirmPasswordPopup",c.prototype.onOpen=function(o,t){this.onConfirm=o,this.action=t},c.prototype.verifyPassword=function(){this.inPropgress(!0),h.send("TwoFactorAuth",this.action,{Password:this.password()},this.onGetVerifyResponse,this)},c.prototype.onGetVerifyResponse=function(o){o.Result?(e.isFunction(this.onConfirm)&&this.onConfirm(o),this.closePopup(),this.password("")):s.showError(r.i18n("TWOFACTORAUTH/ERROR_WRONG_PASSWORD")),this.inPropgress(!1)},o.exports=new c},"7Lti":function(o,t,i){"use strict";(function(t){i("0h2I");var e=i("F/us"),n=i("RN+F"),s=i("AFLV"),r=i("SQrT");o.exports={ServerModuleName:"TwoFactorAuth",HashModuleName:"two-factor-auth",EnableTwoFactorAuth:!1,ShowRecommendationToConfigure:!0,init:function(o){var t=e.extend({},o[this.ServerModuleName]||{},o.TwoFactorAuth||{});e.isEmpty(t)||(this.EnableTwoFactorAuth=s.pBool(t.EnableTwoFactorAuth,this.EnableTwoFactorAuth),this.ShowRecommendationToConfigure=s.pBool(t.ShowRecommendationToConfigure,this.ShowRecommendationToConfigure),this.checkIfEnabled())},update:function(o){this.ShowRecommendationToConfigure=o},checkIfEnabled:function(){var o="settings/two-factor-auth"===window.location.hash||"#settings/two-factor-auth"===window.location.hash;!this.ShowRecommendationToConfigure||this.EnableTwoFactorAuth||o||setTimeout((function(){r.showLoading(n.i18n("TWOFACTORAUTH/CONFIRM_MODULE_NOT_ENABLED")),t(".report_panel.loading a").on("click",(function(){r.hideLoading()})),setTimeout((function(){r.hideLoading()}),1e4)}),100)}}}).call(this,i("EVdn"))},PMya:function(o,t,i){"use strict";var e=i("F/us"),n=i("0h2I"),s=i("SQrT"),r=i("RN+F"),a=i("OgeD").run("SettingsWebclient","getAbstractSettingsFormViewClass"),h=i("7Lti"),c=i("76Kh"),u=i("2xdY"),p=i("o0Bx");function l(){a.call(this,h.ServerModuleName),this.showRecommendationToConfigure=n.observable(h.ShowRecommendationToConfigure),this.isEnabledTwoFactorAuth=n.observable(h.EnableTwoFactorAuth),this.isPasswordVerified=n.observable(!1),this.isShowSecret=n.observable(!1),this.isValidatingPin=n.observable(!1),this.QRCodeSrc=n.observable(""),this.secret=n.observable(""),this.pin=n.observable("")}e.extendOwn(l.prototype,a.prototype),l.prototype.ViewTemplate="TwoFactorAuth_TwoFactorAuthSettingsFormView",l.prototype.confirmPassword=function(){c.showPopup(u,[e.bind(this.onConfirmPassword,this),"EnableTwoFactorAuth"])},l.prototype.onConfirmPassword=function(o){o&&o.Result&&o.Result.Secret&&o.Result.QRcode&&(this.QRCodeSrc(o.Result.QRcode),this.secret(o.Result.Secret),this.isShowSecret(!0),this.disableShowRecommendation())},l.prototype.validatePin=function(){this.isValidatingPin(!0),p.send("TwoFactorAuth","TwoFactorAuthSave",{Pin:this.pin(),Secret:this.secret()},this.onValidatingPinResponse,this)},l.prototype.disableShowRecommendation=function(){this.showRecommendationToConfigure(!1),p.send("TwoFactorAuth","UpdateSettings",{ShowRecommendationToConfigure:!1},(function(){h.update(!1)}))},l.prototype.onValidatingPinResponse=function(o){this.isValidatingPin(!1),o&&o.Result?(this.QRCodeSrc(""),this.secret(""),this.pin(""),this.isShowSecret(!1),this.isEnabledTwoFactorAuth(!0)):s.showError(r.i18n("TWOFACTORAUTH/ERROR_WRONG_PIN"))},l.prototype.disable=function(){c.showPopup(u,[e.bind((function(){this.QRCodeSrc(""),this.secret(""),this.pin(""),this.isShowSecret(!1),this.isEnabledTwoFactorAuth(!1)}),this),"DisableTwoFactorAuth"])},o.exports=new l},Rr39:function(o,t,i){"use strict";var e=i("F/us"),n=i("IAk5"),s=i("RN+F"),r=i("7Lti");o.exports=function(o){return r.init(o),{start:function(o){o.run("SettingsWebclient","registerSettingsTab",[function(){return i("PMya")},r.HashModuleName,s.i18n("TWOFACTORAUTH/LABEL_SETTINGS_TAB")]);var t=function(o){var t=o.View,n=i("76Kh"),s=i("YI4A");if(t){var r=t.onSystemLoginResponse.bind(t);e.isFunction(r)||(r=t.onSystemLoginResponseBase.bind(t)),e.isFunction(r)||(r=function(){}),t.onSystemLoginResponse=function(o,t){null!=t.Parameters.Domain&&(t.Parameters.Login=t.Parameters.Login+"@"+t.Parameters.Domain),o.Result&&o.Result.TwoFactorAuth?n.showPopup(s,[e.bind(this.onSystemLoginResponseBase,this),e.bind((function(){this.loading(!1)}),this),t.Parameters.Login,t.Parameters.Password]):r(o,t)}}}.bind(this);n.subscribeEvent("StandardLoginFormWebclient::ConstructView::after",t),n.subscribeEvent("MailLoginFormWebclient::ConstructView::after",t)}}}},YI4A:function(o,t,i){"use strict";var e=i("F/us"),n=i("0h2I"),s=i("SQrT"),r=i("RN+F"),a=i("czxF"),h=i("o0Bx"),c=i("IAk5");function u(){a.call(this),this.onConfirm=null,this.onCancel=null,this.pin=n.observable(""),this.inPropgress=n.observable(!1),this.pinFocused=n.observable(!1),this.isMobile=n.observable(c.isMobile()||!1),this.Login=null,this.Password=null}e.extendOwn(u.prototype,a.prototype),u.prototype.PopupTemplate="TwoFactorAuth_VerifyTokenPopup",u.prototype.onOpen=function(o,t,i,e){this.onConfirm=o,this.onCancel=t,this.Login=i,this.Password=e,this.pinFocused(!0)},u.prototype.verifyPin=function(){this.inPropgress(!0),h.send("TwoFactorAuth","VerifyPin",{Pin:this.pin(),Login:this.Login,Password:this.Password},this.onGetVerifyResponse,this)},u.prototype.onGetVerifyResponse=function(o){o.Result?(e.isFunction(this.onConfirm)&&this.onConfirm(o),this.closePopup(),this.pin("")):(s.showError(r.i18n("TWOFACTORAUTH/ERROR_WRONG_PIN")),this.pin("")),this.inPropgress(!1)},u.prototype.cancelPopup=function(){e.isFunction(this.onCancel)&&this.onCancel(!1),this.closePopup()},o.exports=new u}}]);